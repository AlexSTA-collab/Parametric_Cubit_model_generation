*node
** Our  nodes
**
*include, input=/home/alexsta1993/Documents/STATHAS_VIENNA_POSTDOC/Applications_Examples/EdelweisModels/Cohesive_Zone_models/3D/Three_Body_Cubit/Linear_Elastic_Interface_examples/Parametric_model/Parametric_model_for_Cubit/Parametric_construction_cubit_Edelweiss/angle_10/mesh_40/include_nodes.inp
********************************** E L E M E N T S ****************************
*element, type=Hexa8, provider=displacementelement, elset=bottom-body
*include, input=/home/alexsta1993/Documents/STATHAS_VIENNA_POSTDOC/Applications_Examples/EdelweisModels/Cohesive_Zone_models/3D/Three_Body_Cubit/Linear_Elastic_Interface_examples/Parametric_model/Parametric_model_for_Cubit/Parametric_construction_cubit_Edelweiss/angle_10/mesh_40/include_elset_bottom.inp

*element, type=IQuad4, provider=interfaceelement, elset=interface-body
*include, input=/home/alexsta1993/Documents/STATHAS_VIENNA_POSTDOC/Applications_Examples/EdelweisModels/Cohesive_Zone_models/3D/Three_Body_Cubit/Linear_Elastic_Interface_examples/Parametric_model/Parametric_model_for_Cubit/Parametric_construction_cubit_Edelweiss/angle_10/mesh_40/include_elset_interface.inp

*element, type=Hexa8, provider=displacementelement, elset=top-body
*include, input=/home/alexsta1993/Documents/STATHAS_VIENNA_POSTDOC/Applications_Examples/EdelweisModels/Cohesive_Zone_models/3D/Three_Body_Cubit/Linear_Elastic_Interface_examples/Parametric_model/Parametric_model_for_Cubit/Parametric_construction_cubit_Edelweiss/angle_10/mesh_40/include_elset_top.inp

********************************** N O D E S E T S **********************************
*NSET, NSET=bottom-Z+
*include, input=/home/alexsta1993/Documents/STATHAS_VIENNA_POSTDOC/Applications_Examples/EdelweisModels/Cohesive_Zone_models/3D/Three_Body_Cubit/Linear_Elastic_Interface_examples/Parametric_model/Parametric_model_for_Cubit/Parametric_construction_cubit_Edelweiss/angle_10/mesh_40/include_nset_bottom-Z+.inp
*NSET, NSET=bottom-Y+
*include, input=/home/alexsta1993/Documents/STATHAS_VIENNA_POSTDOC/Applications_Examples/EdelweisModels/Cohesive_Zone_models/3D/Three_Body_Cubit/Linear_Elastic_Interface_examples/Parametric_model/Parametric_model_for_Cubit/Parametric_construction_cubit_Edelweiss/angle_10/mesh_40/include_nset_bottom-Y+.inp
*NSET, NSET=bottom-X+
*include, input=/home/alexsta1993/Documents/STATHAS_VIENNA_POSTDOC/Applications_Examples/EdelweisModels/Cohesive_Zone_models/3D/Three_Body_Cubit/Linear_Elastic_Interface_examples/Parametric_model/Parametric_model_for_Cubit/Parametric_construction_cubit_Edelweiss/angle_10/mesh_40/include_nset_bottom-X+.inp
*NSET, NSET=bottom-Z-
*include, input=/home/alexsta1993/Documents/STATHAS_VIENNA_POSTDOC/Applications_Examples/EdelweisModels/Cohesive_Zone_models/3D/Three_Body_Cubit/Linear_Elastic_Interface_examples/Parametric_model/Parametric_model_for_Cubit/Parametric_construction_cubit_Edelweiss/angle_10/mesh_40/include_nset_bottom-Z-.inp
*NSET, NSET=bottom-Y-
*include, input=/home/alexsta1993/Documents/STATHAS_VIENNA_POSTDOC/Applications_Examples/EdelweisModels/Cohesive_Zone_models/3D/Three_Body_Cubit/Linear_Elastic_Interface_examples/Parametric_model/Parametric_model_for_Cubit/Parametric_construction_cubit_Edelweiss/angle_10/mesh_40/include_nset_bottom-Y-.inp
*NSET, NSET=bottom-X-
*include, input=/home/alexsta1993/Documents/STATHAS_VIENNA_POSTDOC/Applications_Examples/EdelweisModels/Cohesive_Zone_models/3D/Three_Body_Cubit/Linear_Elastic_Interface_examples/Parametric_model/Parametric_model_for_Cubit/Parametric_construction_cubit_Edelweiss/angle_10/mesh_40/include_nset_bottom-X-.inp
*NSET, NSET=top-Z-
*include, input=/home/alexsta1993/Documents/STATHAS_VIENNA_POSTDOC/Applications_Examples/EdelweisModels/Cohesive_Zone_models/3D/Three_Body_Cubit/Linear_Elastic_Interface_examples/Parametric_model/Parametric_model_for_Cubit/Parametric_construction_cubit_Edelweiss/angle_10/mesh_40/include_nset_top-Z-.inp
*NSET, NSET=top-Y+
*include, input=/home/alexsta1993/Documents/STATHAS_VIENNA_POSTDOC/Applications_Examples/EdelweisModels/Cohesive_Zone_models/3D/Three_Body_Cubit/Linear_Elastic_Interface_examples/Parametric_model/Parametric_model_for_Cubit/Parametric_construction_cubit_Edelweiss/angle_10/mesh_40/include_nset_top-Y+.inp
*NSET, NSET=top-X-
*include, input=/home/alexsta1993/Documents/STATHAS_VIENNA_POSTDOC/Applications_Examples/EdelweisModels/Cohesive_Zone_models/3D/Three_Body_Cubit/Linear_Elastic_Interface_examples/Parametric_model/Parametric_model_for_Cubit/Parametric_construction_cubit_Edelweiss/angle_10/mesh_40/include_nset_top-X-.inp
*NSET, NSET=top-Z+
*include, input=/home/alexsta1993/Documents/STATHAS_VIENNA_POSTDOC/Applications_Examples/EdelweisModels/Cohesive_Zone_models/3D/Three_Body_Cubit/Linear_Elastic_Interface_examples/Parametric_model/Parametric_model_for_Cubit/Parametric_construction_cubit_Edelweiss/angle_10/mesh_40/include_nset_top-Z+.inp
*NSET, NSET=top-Y-
*include, input=/home/alexsta1993/Documents/STATHAS_VIENNA_POSTDOC/Applications_Examples/EdelweisModels/Cohesive_Zone_models/3D/Three_Body_Cubit/Linear_Elastic_Interface_examples/Parametric_model/Parametric_model_for_Cubit/Parametric_construction_cubit_Edelweiss/angle_10/mesh_40/include_nset_top-Y-.inp
*NSET, NSET=top-X+
*include, input=/home/alexsta1993/Documents/STATHAS_VIENNA_POSTDOC/Applications_Examples/EdelweisModels/Cohesive_Zone_models/3D/Three_Body_Cubit/Linear_Elastic_Interface_examples/Parametric_model/Parametric_model_for_Cubit/Parametric_construction_cubit_Edelweiss/angle_10/mesh_40/include_nset_top-X+.inp

*material, name=LinearElastic, id=linearelastic_body_1, provider=edelweissmaterial
**Isotropic
**E    nu
1.0, 0.3

*material, name=LinearElastic, id=linearelastic_body_2, provider=edelweissmaterial
**Isotropic
**E    nu
1.0, 0.3

*material, name=marmotinterfacematerial, id=ElasticInterfaceMaterial, provider = edelweissmaterial
** E_M, nu_M, E_I, nu_I, E_0 , nu_0, h, MaterialID 
1.0, 0.3, 1.0, 0.3, 10000.0, 0.3, 1e-08, 0

*section, name=section1, material=linearelastic_body_2, type=solid
bottom-body

*section, name=section2, material=linearelastic_body_1, type=solid
top-body

*section, name=section3, material=ElasticInterfaceMaterial, type=solid
interface-body

*job, name=IQuad4job, domain=3d
*solver, solver=NIST, name=theSolver

*fieldOutput
create=perNode, elSet=top-body, field=displacement, result=U, name=displacement_top
create=perNode, elSet=bottom-body, field=displacement, result=U, name=displacement_bottom
create=perNode, elSet=interface-body, field=displacement, result=U, name=displacement_interface
create=perElement, elSet=top-body, quadraturePoint=0:8, result=stress , name=stress_top, f(x)='np.mean(x,axis=1)' 
create=perElement, elSet=bottom-body, quadraturePoint=0:8, result=stress , name=stress_bottom, f(x)='np.mean(x,axis=1)' 

*output, type=ensight, name=Cohesive_zone_model_interface
create=perNode, fieldOutput=displacement_interface
configuration, overwrite=yes

*output, type=ensight, name=Cohesive_zone_model_top
create=perNode, fieldOutput=displacement_top
create=perElement, fieldOutput=stress_top
configuration, overwrite=yes

*output, type=ensight, name=Cohesive_zone_model_bottom
create=perNode,  fieldOutput=displacement_bottom
create=perElement, fieldOutput=stress_bottom
configuration, overwrite=yes

*step, solver=theSolver, maxInc=1e-1, minInc=1e-3, maxNumInc=1000, maxIter=1000, stepLength=1
options, category=NISTSolver, extrapolation=off

dirichlet, name = bottom,       nSet = bottom-Z-,  field=displacement, 1=1, 2=0, 3=0
dirichlet, name = top,          nSet = top-Z+,     field=displacement, 1=-1, 2=0, 3=0
